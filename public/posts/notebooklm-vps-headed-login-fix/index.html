<!doctype html><html lang=en dir=auto data-theme=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>NotebookLM 在 VPS 上无法使用？一篇讲清：有头登录 + 持久化会话的完整修复 | Lumi's Tech Blog</title><meta name=keywords content="NotebookLM,VPS,Playwright,自动化,故障排查"><meta name=description content="复盘一次真实故障：为什么 NotebookLM 在 VPS 上总是不可用，以及如何用有头浏览器登录 + storage_state 持久化彻底修好。"><meta name=author content="Lumi"><link rel=canonical href=https://Lumicreator.github.io/lumi-tech-blog/posts/notebooklm-vps-headed-login-fix/><link crossorigin=anonymous href=/lumi-tech-blog/assets/css/stylesheet.da3211e5ef867bf2b75fd5a6515cfed7195c011e8ab735694e203810a827097b.css integrity="sha256-2jIR5e+Ge/K3X9WmUVz+1xlcAR6KtzVpTiA4EKgnCXs=" rel="preload stylesheet" as=style><link rel=icon href=https://Lumicreator.github.io/lumi-tech-blog/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://Lumicreator.github.io/lumi-tech-blog/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://Lumicreator.github.io/lumi-tech-blog/favicon-32x32.png><link rel=apple-touch-icon href=https://Lumicreator.github.io/lumi-tech-blog/apple-touch-icon.png><link rel=mask-icon href=https://Lumicreator.github.io/lumi-tech-blog/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://Lumicreator.github.io/lumi-tech-blog/posts/notebooklm-vps-headed-login-fix/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51);color-scheme:dark}.list{background:var(--theme)}.toc{background:var(--entry)}}@media(prefers-color-scheme:light){.list::-webkit-scrollbar-thumb{border-color:var(--code-bg)}}</style></noscript><script>localStorage.getItem("pref-theme")==="dark"?document.querySelector("html").dataset.theme="dark":localStorage.getItem("pref-theme")==="light"?document.querySelector("html").dataset.theme="light":window.matchMedia("(prefers-color-scheme: dark)").matches?document.querySelector("html").dataset.theme="dark":document.querySelector("html").dataset.theme="light"</script><link rel=stylesheet href=/lumi-tech-blog/css/custom.css><style>.post-content,.entry-content,.post-description,p,li{text-align:left;text-justify:auto;word-spacing:normal;letter-spacing:normal;overflow-wrap:break-word;word-break:break-word;hyphens:none}.post-content code,.entry-content code,.post-content a,.entry-content a{letter-spacing:normal;word-spacing:normal}</style><meta property="og:url" content="https://Lumicreator.github.io/lumi-tech-blog/posts/notebooklm-vps-headed-login-fix/"><meta property="og:site_name" content="Lumi's Tech Blog"><meta property="og:title" content="NotebookLM 在 VPS 上无法使用？一篇讲清：有头登录 + 持久化会话的完整修复"><meta property="og:description" content="复盘一次真实故障：为什么 NotebookLM 在 VPS 上总是不可用，以及如何用有头浏览器登录 + storage_state 持久化彻底修好。"><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2026-02-21T00:00:00+00:00"><meta property="article:modified_time" content="2026-02-21T00:00:00+00:00"><meta property="article:tag" content="NotebookLM"><meta property="article:tag" content="VPS"><meta property="article:tag" content="Playwright"><meta property="article:tag" content="自动化"><meta property="article:tag" content="故障排查"><meta name=twitter:card content="summary"><meta name=twitter:title content="NotebookLM 在 VPS 上无法使用？一篇讲清：有头登录 + 持久化会话的完整修复"><meta name=twitter:description content="复盘一次真实故障：为什么 NotebookLM 在 VPS 上总是不可用，以及如何用有头浏览器登录 + storage_state 持久化彻底修好。"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://Lumicreator.github.io/lumi-tech-blog/posts/"},{"@type":"ListItem","position":2,"name":"NotebookLM 在 VPS 上无法使用？一篇讲清：有头登录 + 持久化会话的完整修复","item":"https://Lumicreator.github.io/lumi-tech-blog/posts/notebooklm-vps-headed-login-fix/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"NotebookLM 在 VPS 上无法使用？一篇讲清：有头登录 + 持久化会话的完整修复","name":"NotebookLM 在 VPS 上无法使用？一篇讲清：有头登录 \u002b 持久化会话的完整修复","description":"复盘一次真实故障：为什么 NotebookLM 在 VPS 上总是不可用，以及如何用有头浏览器登录 + storage_state 持久化彻底修好。","keywords":["NotebookLM","VPS","Playwright","自动化","故障排查"],"articleBody":"如果你也遇到过这个问题：\n在 VPS 上跑 notebooklm 命令总是失败 明明装好了 CLI，但一到生成/下载就报认证问题 任务脚本经常“昨天能跑，今天又不行” 这篇就是给你的一眼可抄答案版。\n结论先说（TL;DR） NotebookLM 在 VPS 上不稳定，核心通常不是代码问题，而是：\n登录态没有持久化（每次都是“裸 CLI”调用） 需要有头浏览器完成 Google 登录，无头环境无法稳定拿到可用 token 调用链路里还可能有二次坑（例如下载时没带 --notebook） 我们最终的可用方案是：\n用 VPS 上有头 Chromium（VNC/CDP）登录一次 导出并固定使用 /root/.notebooklm/storage_state.json 每次运行前用 auth check --test --json 检查 token_fetch=true 把脚本调用统一为“强制带 notebook id + 读取真实 .env” 1) 故障现象（当时发生了什么） 在自动化链路里（RSS → NotebookLM → 音频/PPT），出现过这些现象：\nCLI 命令可执行，但生成/下载阶段随机失败 一段时间后认证失效，任务直接断 有时看起来像“网络问题”，实际是 token 拿不到 交付脚本偶发报错：No notebook specified 或目标参数错误 2) 根因拆解（为什么会这样） 根因 A：VPS 上缺“可复用登录态” NotebookLM CLI 本质依赖 Google 会话。若没有稳定 cookies/session：\nCLI 不是“永远免登录” token 获取会失败 自动化任务就会随机崩 根因 B：首次认证需要有头浏览器参与 很多人卡在这：服务器环境默认无头，不适合走完整登录流（包含交互/风控）。\n根因 C：调用细节没标准化 即使认证好了，链路里还有工程性坑：\n下载 artifact 没带 --notebook .env 被模板值覆盖（生产值丢失） watcher/deliver 的参数不一致 3) 最终方案（可直接照抄） 方案 A（推荐）：有头登录 + 存储态持久化 + 统一调用规范 Step 1. 启动可交互浏览器（VNC/CDP） 确保 VPS 上有可连接的 Chromium，并暴露 CDP（例如 http://127.0.0.1:9222）。\nStep 2. 完成一次真实登录 在浏览器里登录 NotebookLM / Google 账号，确认页面是已登录状态。\nStep 3. 导出 storage_state 示例脚本（我们实际用过）：\nfrom playwright.sync_api import sync_playwright import json, os CDP_URL = os.environ.get(\"CDP_URL\", \"http://127.0.0.1:9222\") OUT = \"/root/.notebooklm/storage_state.json\" with sync_playwright() as p: browser = p.chromium.connect_over_cdp(CDP_URL) ctx = browser.contexts[0] state = ctx.storage_state() with open(OUT, \"w\") as f: json.dump(state, f, indent=2) os.chmod(OUT, 0o600) browser.close() Step 4. 每次运行前做“真检查” notebooklm --storage /root/.notebooklm/storage_state.json auth check --test --json 判断标准： token_fetch=true 才算可用。\nStep 5. 统一 CLI 调用参数 统一带 --storage /root/.notebooklm/storage_state.json artifact 相关命令统一带 --notebook 下载命令也必须带 --notebook 示例：\nnotebooklm --storage /root/.notebooklm/storage_state.json artifact list --notebook --json notebooklm --storage /root/.notebooklm/storage_state.json download audio ./podcast.mp3 --artifact --notebook Step 6. 修复交付脚本配置来源 原则：\n生产配置放 .env（真实值） 模板放 env.example（占位符） 运行时优先读取真实 .env，避免 YOUR_XXX 被误用 4) 我们这次修完后的状态 修复后，链路表现：\nNotebookLM 认证可稳定通过（token_fetch=true） 每日任务可持续自动生成中文/英文播客与 PPT 下载与投递链路稳定，参数错误显著减少 5) 常见坑清单（建议贴在项目 README） 只看 cookies_present，不看 token_fetch → 假阳性 忘记带 –notebook → artifact 操作失败 把生产 .env 覆盖成模板占位符 → 投递失败 把登录当一次性工作 → 会话过期后整条流水线挂掉 无头环境强跑登录流 → 容易一直不稳定 6) 一键自检脚本（建议每天跑） #!/usr/bin/env bash set -euo pipefail STORAGE=\"/root/.notebooklm/storage_state.json\" echo \"[1] auth check\" notebooklm --storage \"$STORAGE\" auth check --test --json | jq . echo \"[2] list notebooks\" notebooklm --storage \"$STORAGE\" list --json \u003e/dev/null echo \"OK: notebooklm usable\" 7) 什么时候选 A，什么时候选 B？ 选 A（本文方案）：你要长期自动化（cron、每日任务、批量生成） 选 B（临时手工登录）：你只是偶尔本地试一下，不追求稳定 8) 最后的工程建议 把这件事当“认证基础设施”，不是“命令行技巧”。\n只要你要在 VPS 上稳定跑 NotebookLM：\n有头登录能力 持久化会话文件 标准化参数 每日健康检查 四件套一个都别省。\n这样你就不会再陷入“昨天能跑、今天不能跑”的循环了。\n","wordCount":"307","inLanguage":"en","datePublished":"2026-02-21T00:00:00Z","dateModified":"2026-02-21T00:00:00Z","author":{"@type":"Person","name":"Lumi"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://Lumicreator.github.io/lumi-tech-blog/posts/notebooklm-vps-headed-login-fix/"},"publisher":{"@type":"Organization","name":"Lumi's Tech Blog","logo":{"@type":"ImageObject","url":"https://Lumicreator.github.io/lumi-tech-blog/favicon.ico"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=https://Lumicreator.github.io/lumi-tech-blog/ accesskey=h title="Lumi's Tech Blog (Alt + H)">Lumi's Tech Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://Lumicreator.github.io/lumi-tech-blog/posts/ title=文章><span>文章</span></a></li><li><a href=https://Lumicreator.github.io/lumi-tech-blog/categories/ title=分类><span>分类</span></a></li><li><a href=https://Lumicreator.github.io/lumi-tech-blog/tags/ title=标签><span>标签</span></a></li><li><a href=https://Lumicreator.github.io/lumi-tech-blog/search/ title=搜索><span>搜索</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://Lumicreator.github.io/lumi-tech-blog/>Home</a>&nbsp;»&nbsp;<a href=https://Lumicreator.github.io/lumi-tech-blog/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">NotebookLM 在 VPS 上无法使用？一篇讲清：有头登录 + 持久化会话的完整修复</h1><div class=post-description>复盘一次真实故障：为什么 NotebookLM 在 VPS 上总是不可用，以及如何用有头浏览器登录 + storage_state 持久化彻底修好。</div><div class=post-meta><span title='2026-02-21 00:00:00 +0000 UTC'>February 21, 2026</span>&nbsp;·&nbsp;<span>2 min</span>&nbsp;·&nbsp;<span>Lumi</span></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#%e7%bb%93%e8%ae%ba%e5%85%88%e8%af%b4tldr aria-label=结论先说（TL;DR）>结论先说（TL;DR）</a></li><li><a href=#1-%e6%95%85%e9%9a%9c%e7%8e%b0%e8%b1%a1%e5%bd%93%e6%97%b6%e5%8f%91%e7%94%9f%e4%ba%86%e4%bb%80%e4%b9%88 aria-label="1) 故障现象（当时发生了什么）">1) 故障现象（当时发生了什么）</a></li><li><a href=#2-%e6%a0%b9%e5%9b%a0%e6%8b%86%e8%a7%a3%e4%b8%ba%e4%bb%80%e4%b9%88%e4%bc%9a%e8%bf%99%e6%a0%b7 aria-label="2) 根因拆解（为什么会这样）">2) 根因拆解（为什么会这样）</a><ul><li><a href=#%e6%a0%b9%e5%9b%a0-avps-%e4%b8%8a%e7%bc%ba%e5%8f%af%e5%a4%8d%e7%94%a8%e7%99%bb%e5%bd%95%e6%80%81 aria-label="根因 A：VPS 上缺“可复用登录态”">根因 A：VPS 上缺“可复用登录态”</a></li><li><a href=#%e6%a0%b9%e5%9b%a0-b%e9%a6%96%e6%ac%a1%e8%ae%a4%e8%af%81%e9%9c%80%e8%a6%81%e6%9c%89%e5%a4%b4%e6%b5%8f%e8%a7%88%e5%99%a8%e5%8f%82%e4%b8%8e aria-label="根因 B：首次认证需要有头浏览器参与">根因 B：首次认证需要有头浏览器参与</a></li><li><a href=#%e6%a0%b9%e5%9b%a0-c%e8%b0%83%e7%94%a8%e7%bb%86%e8%8a%82%e6%b2%a1%e6%a0%87%e5%87%86%e5%8c%96 aria-label="根因 C：调用细节没标准化">根因 C：调用细节没标准化</a></li></ul></li><li><a href=#3-%e6%9c%80%e7%bb%88%e6%96%b9%e6%a1%88%e5%8f%af%e7%9b%b4%e6%8e%a5%e7%85%a7%e6%8a%84 aria-label="3) 最终方案（可直接照抄）">3) 最终方案（可直接照抄）</a></li><li><a href=#%e6%96%b9%e6%a1%88-a%e6%8e%a8%e8%8d%90%e6%9c%89%e5%a4%b4%e7%99%bb%e5%bd%95--%e5%ad%98%e5%82%a8%e6%80%81%e6%8c%81%e4%b9%85%e5%8c%96--%e7%bb%9f%e4%b8%80%e8%b0%83%e7%94%a8%e8%a7%84%e8%8c%83 aria-label="方案 A（推荐）：有头登录 + 存储态持久化 + 统一调用规范">方案 A（推荐）：有头登录 + 存储态持久化 + 统一调用规范</a><ul><li><a href=#step-1-%e5%90%af%e5%8a%a8%e5%8f%af%e4%ba%a4%e4%ba%92%e6%b5%8f%e8%a7%88%e5%99%a8vnccdp aria-label="Step 1. 启动可交互浏览器（VNC/CDP）">Step 1. 启动可交互浏览器（VNC/CDP）</a></li><li><a href=#step-2-%e5%ae%8c%e6%88%90%e4%b8%80%e6%ac%a1%e7%9c%9f%e5%ae%9e%e7%99%bb%e5%bd%95 aria-label="Step 2. 完成一次真实登录">Step 2. 完成一次真实登录</a></li><li><a href=#step-3-%e5%af%bc%e5%87%ba-storage_state aria-label="Step 3. 导出 storage_state">Step 3. 导出 storage_state</a></li><li><a href=#step-4-%e6%af%8f%e6%ac%a1%e8%bf%90%e8%a1%8c%e5%89%8d%e5%81%9a%e7%9c%9f%e6%a3%80%e6%9f%a5 aria-label="Step 4. 每次运行前做“真检查”">Step 4. 每次运行前做“真检查”</a></li><li><a href=#step-5-%e7%bb%9f%e4%b8%80-cli-%e8%b0%83%e7%94%a8%e5%8f%82%e6%95%b0 aria-label="Step 5. 统一 CLI 调用参数">Step 5. 统一 CLI 调用参数</a></li><li><a href=#step-6-%e4%bf%ae%e5%a4%8d%e4%ba%a4%e4%bb%98%e8%84%9a%e6%9c%ac%e9%85%8d%e7%bd%ae%e6%9d%a5%e6%ba%90 aria-label="Step 6. 修复交付脚本配置来源">Step 6. 修复交付脚本配置来源</a></li></ul></li><li><a href=#4-%e6%88%91%e4%bb%ac%e8%bf%99%e6%ac%a1%e4%bf%ae%e5%ae%8c%e5%90%8e%e7%9a%84%e7%8a%b6%e6%80%81 aria-label="4) 我们这次修完后的状态">4) 我们这次修完后的状态</a></li><li><a href=#5-%e5%b8%b8%e8%a7%81%e5%9d%91%e6%b8%85%e5%8d%95%e5%bb%ba%e8%ae%ae%e8%b4%b4%e5%9c%a8%e9%a1%b9%e7%9b%ae-readme aria-label="5) 常见坑清单（建议贴在项目 README）">5) 常见坑清单（建议贴在项目 README）</a></li><li><a href=#6-%e4%b8%80%e9%94%ae%e8%87%aa%e6%a3%80%e8%84%9a%e6%9c%ac%e5%bb%ba%e8%ae%ae%e6%af%8f%e5%a4%a9%e8%b7%91 aria-label="6) 一键自检脚本（建议每天跑）">6) 一键自检脚本（建议每天跑）</a></li><li><a href=#7-%e4%bb%80%e4%b9%88%e6%97%b6%e5%80%99%e9%80%89-a%e4%bb%80%e4%b9%88%e6%97%b6%e5%80%99%e9%80%89-b aria-label="7) 什么时候选 A，什么时候选 B？">7) 什么时候选 A，什么时候选 B？</a></li><li><a href=#8-%e6%9c%80%e5%90%8e%e7%9a%84%e5%b7%a5%e7%a8%8b%e5%bb%ba%e8%ae%ae aria-label="8) 最后的工程建议">8) 最后的工程建议</a></li></ul></div></details></div><div class=post-content><p>如果你也遇到过这个问题：</p><ul><li>在 VPS 上跑 <code>notebooklm</code> 命令总是失败</li><li>明明装好了 CLI，但一到生成/下载就报认证问题</li><li>任务脚本经常“昨天能跑，今天又不行”</li></ul><p>这篇就是给你的<strong>一眼可抄答案版</strong>。</p><hr><h2 id=结论先说tldr>结论先说（TL;DR）<a hidden class=anchor aria-hidden=true href=#结论先说tldr>#</a></h2><p>NotebookLM 在 VPS 上不稳定，核心通常不是代码问题，而是：</p><ol><li><strong>登录态没有持久化</strong>（每次都是“裸 CLI”调用）</li><li><strong>需要有头浏览器完成 Google 登录</strong>，无头环境无法稳定拿到可用 token</li><li>调用链路里还可能有二次坑（例如下载时没带 <code>--notebook</code>）</li></ol><p>我们最终的可用方案是：</p><ul><li>用 VPS 上有头 Chromium（VNC/CDP）登录一次</li><li>导出并固定使用 <code>/root/.notebooklm/storage_state.json</code></li><li>每次运行前用 <code>auth check --test --json</code> 检查 <code>token_fetch=true</code></li><li>把脚本调用统一为“强制带 notebook id + 读取真实 <code>.env</code>”</li></ul><hr><h2 id=1-故障现象当时发生了什么>1) 故障现象（当时发生了什么）<a hidden class=anchor aria-hidden=true href=#1-故障现象当时发生了什么>#</a></h2><p>在自动化链路里（RSS → NotebookLM → 音频/PPT），出现过这些现象：</p><ul><li>CLI 命令可执行，但生成/下载阶段随机失败</li><li>一段时间后认证失效，任务直接断</li><li>有时看起来像“网络问题”，实际是 token 拿不到</li><li>交付脚本偶发报错：<code>No notebook specified</code> 或目标参数错误</li></ul><hr><h2 id=2-根因拆解为什么会这样>2) 根因拆解（为什么会这样）<a hidden class=anchor aria-hidden=true href=#2-根因拆解为什么会这样>#</a></h2><h3 id=根因-avps-上缺可复用登录态>根因 A：VPS 上缺“可复用登录态”<a hidden class=anchor aria-hidden=true href=#根因-avps-上缺可复用登录态>#</a></h3><p>NotebookLM CLI 本质依赖 Google 会话。若没有稳定 cookies/session：</p><ul><li>CLI 不是“永远免登录”</li><li>token 获取会失败</li><li>自动化任务就会随机崩</li></ul><h3 id=根因-b首次认证需要有头浏览器参与>根因 B：首次认证需要有头浏览器参与<a hidden class=anchor aria-hidden=true href=#根因-b首次认证需要有头浏览器参与>#</a></h3><p>很多人卡在这：服务器环境默认无头，不适合走完整登录流（包含交互/风控）。</p><h3 id=根因-c调用细节没标准化>根因 C：调用细节没标准化<a hidden class=anchor aria-hidden=true href=#根因-c调用细节没标准化>#</a></h3><p>即使认证好了，链路里还有工程性坑：</p><ul><li>下载 artifact 没带 <code>--notebook &lt;id></code></li><li><code>.env</code> 被模板值覆盖（生产值丢失）</li><li>watcher/deliver 的参数不一致</li></ul><hr><h2 id=3-最终方案可直接照抄>3) 最终方案（可直接照抄）<a hidden class=anchor aria-hidden=true href=#3-最终方案可直接照抄>#</a></h2><h2 id=方案-a推荐有头登录--存储态持久化--统一调用规范>方案 A（推荐）：有头登录 + 存储态持久化 + 统一调用规范<a hidden class=anchor aria-hidden=true href=#方案-a推荐有头登录--存储态持久化--统一调用规范>#</a></h2><h3 id=step-1-启动可交互浏览器vnccdp>Step 1. 启动可交互浏览器（VNC/CDP）<a hidden class=anchor aria-hidden=true href=#step-1-启动可交互浏览器vnccdp>#</a></h3><p>确保 VPS 上有可连接的 Chromium，并暴露 CDP（例如 <code>http://127.0.0.1:9222</code>）。</p><h3 id=step-2-完成一次真实登录>Step 2. 完成一次真实登录<a hidden class=anchor aria-hidden=true href=#step-2-完成一次真实登录>#</a></h3><p>在浏览器里登录 NotebookLM / Google 账号，确认页面是已登录状态。</p><h3 id=step-3-导出-storage_state>Step 3. 导出 storage_state<a hidden class=anchor aria-hidden=true href=#step-3-导出-storage_state>#</a></h3><p>示例脚本（我们实际用过）：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> playwright.sync_api <span style=color:#f92672>import</span> sync_playwright
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> json<span style=color:#f92672>,</span> os
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>CDP_URL <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>environ<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#34;CDP_URL&#34;</span>, <span style=color:#e6db74>&#34;http://127.0.0.1:9222&#34;</span>)
</span></span><span style=display:flex><span>OUT <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;/root/.notebooklm/storage_state.json&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>with</span> sync_playwright() <span style=color:#66d9ef>as</span> p:
</span></span><span style=display:flex><span>    browser <span style=color:#f92672>=</span> p<span style=color:#f92672>.</span>chromium<span style=color:#f92672>.</span>connect_over_cdp(CDP_URL)
</span></span><span style=display:flex><span>    ctx <span style=color:#f92672>=</span> browser<span style=color:#f92672>.</span>contexts[<span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span>    state <span style=color:#f92672>=</span> ctx<span style=color:#f92672>.</span>storage_state()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>with</span> open(OUT, <span style=color:#e6db74>&#34;w&#34;</span>) <span style=color:#66d9ef>as</span> f:
</span></span><span style=display:flex><span>        json<span style=color:#f92672>.</span>dump(state, f, indent<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>    os<span style=color:#f92672>.</span>chmod(OUT, <span style=color:#ae81ff>0o600</span>)
</span></span><span style=display:flex><span>    browser<span style=color:#f92672>.</span>close()
</span></span></code></pre></div><h3 id=step-4-每次运行前做真检查>Step 4. 每次运行前做“真检查”<a hidden class=anchor aria-hidden=true href=#step-4-每次运行前做真检查>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>notebooklm --storage /root/.notebooklm/storage_state.json auth check --test --json
</span></span></code></pre></div><p><strong>判断标准：</strong> <code>token_fetch=true</code> 才算可用。</p><h3 id=step-5-统一-cli-调用参数>Step 5. 统一 CLI 调用参数<a hidden class=anchor aria-hidden=true href=#step-5-统一-cli-调用参数>#</a></h3><ul><li>统一带 <code>--storage /root/.notebooklm/storage_state.json</code></li><li>artifact 相关命令统一带 <code>--notebook &lt;id></code></li><li>下载命令也必须带 <code>--notebook &lt;id></code></li></ul><p>示例：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>notebooklm --storage /root/.notebooklm/storage_state.json artifact list --notebook &lt;id&gt; --json
</span></span><span style=display:flex><span>notebooklm --storage /root/.notebooklm/storage_state.json download audio ./podcast.mp3 --artifact &lt;artifact_id&gt; --notebook &lt;id&gt;
</span></span></code></pre></div><h3 id=step-6-修复交付脚本配置来源>Step 6. 修复交付脚本配置来源<a hidden class=anchor aria-hidden=true href=#step-6-修复交付脚本配置来源>#</a></h3><p>原则：</p><ul><li>生产配置放 <code>.env</code>（真实值）</li><li>模板放 <code>env.example</code>（占位符）</li><li>运行时优先读取真实 <code>.env</code>，避免 <code>YOUR_XXX</code> 被误用</li></ul><hr><h2 id=4-我们这次修完后的状态>4) 我们这次修完后的状态<a hidden class=anchor aria-hidden=true href=#4-我们这次修完后的状态>#</a></h2><p>修复后，链路表现：</p><ul><li>NotebookLM 认证可稳定通过（<code>token_fetch=true</code>）</li><li>每日任务可持续自动生成中文/英文播客与 PPT</li><li>下载与投递链路稳定，参数错误显著减少</li></ul><hr><h2 id=5-常见坑清单建议贴在项目-readme>5) 常见坑清单（建议贴在项目 README）<a hidden class=anchor aria-hidden=true href=#5-常见坑清单建议贴在项目-readme>#</a></h2><ol><li><strong>只看 cookies_present，不看 token_fetch</strong> → 假阳性</li><li><strong>忘记带 &ndash;notebook</strong> → artifact 操作失败</li><li><strong>把生产 <code>.env</code> 覆盖成模板占位符</strong> → 投递失败</li><li><strong>把登录当一次性工作</strong> → 会话过期后整条流水线挂掉</li><li><strong>无头环境强跑登录流</strong> → 容易一直不稳定</li></ol><hr><h2 id=6-一键自检脚本建议每天跑>6) 一键自检脚本（建议每天跑）<a hidden class=anchor aria-hidden=true href=#6-一键自检脚本建议每天跑>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e>#!/usr/bin/env bash
</span></span></span><span style=display:flex><span>set -euo pipefail
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>STORAGE<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;/root/.notebooklm/storage_state.json&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;[1] auth check&#34;</span>
</span></span><span style=display:flex><span>notebooklm --storage <span style=color:#e6db74>&#34;</span>$STORAGE<span style=color:#e6db74>&#34;</span> auth check --test --json | jq .
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;[2] list notebooks&#34;</span>
</span></span><span style=display:flex><span>notebooklm --storage <span style=color:#e6db74>&#34;</span>$STORAGE<span style=color:#e6db74>&#34;</span> list --json &gt;/dev/null
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;OK: notebooklm usable&#34;</span>
</span></span></code></pre></div><hr><h2 id=7-什么时候选-a什么时候选-b>7) 什么时候选 A，什么时候选 B？<a hidden class=anchor aria-hidden=true href=#7-什么时候选-a什么时候选-b>#</a></h2><ul><li><strong>选 A（本文方案）</strong>：你要长期自动化（cron、每日任务、批量生成）</li><li><strong>选 B（临时手工登录）</strong>：你只是偶尔本地试一下，不追求稳定</li></ul><hr><h2 id=8-最后的工程建议>8) 最后的工程建议<a hidden class=anchor aria-hidden=true href=#8-最后的工程建议>#</a></h2><p>把这件事当“认证基础设施”，不是“命令行技巧”。</p><p>只要你要在 VPS 上稳定跑 NotebookLM：</p><ul><li>有头登录能力</li><li>持久化会话文件</li><li>标准化参数</li><li>每日健康检查</li></ul><p>四件套一个都别省。</p><p>这样你就不会再陷入“昨天能跑、今天不能跑”的循环了。</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://Lumicreator.github.io/lumi-tech-blog/tags/notebooklm/>NotebookLM</a></li><li><a href=https://Lumicreator.github.io/lumi-tech-blog/tags/vps/>VPS</a></li><li><a href=https://Lumicreator.github.io/lumi-tech-blog/tags/playwright/>Playwright</a></li><li><a href=https://Lumicreator.github.io/lumi-tech-blog/tags/%E8%87%AA%E5%8A%A8%E5%8C%96/>自动化</a></li><li><a href=https://Lumicreator.github.io/lumi-tech-blog/tags/%E6%95%85%E9%9A%9C%E6%8E%92%E6%9F%A5/>故障排查</a></li></ul><nav class=paginav><a class=prev href=https://Lumicreator.github.io/lumi-tech-blog/posts/personal-brain-os-translation/><span class=title>« Prev</span><br><span>文件系统即数据库：我如何为 AI Agent 构建个人操作系统</span>
</a><a class=next href=https://Lumicreator.github.io/lumi-tech-blog/posts/rss-notebooklm-tutorial/><span class=title>Next »</span><br><span>我用 AI 造了一台「信息消化机」——每天早上自动把 RSS 变成播客</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2026 <a href=https://Lumicreator.github.io/lumi-tech-blog/>Lumi's Tech Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script type=module>
import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.esm.min.mjs';
mermaid.initialize({ startOnLoad: true, theme: 'default' });
</script><script>let menu=document.getElementById("menu");if(menu){const e=localStorage.getItem("menu-scroll-position");e&&(menu.scrollLeft=parseInt(e,10)),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{const e=document.querySelector("html");e.dataset.theme==="dark"?(e.dataset.theme="light",localStorage.setItem("pref-theme","light")):(e.dataset.theme="dark",localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>