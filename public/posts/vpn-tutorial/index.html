<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>ä¿å§†çº§ VLESS &#43; Reality &amp; CDN åŠ é€Ÿå…¨æŒ‡å— | Lumi&#39;s Tech Blog</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="ä¿å§†çº§ VLESS&#43;Reality æ•™ç¨‹ï¼šå•æœåŠ¡å™¨éƒ¨ç½²ç›´è¿ä¸ CDN å¤‡ç”¨çº¿è·¯ï¼Œæ¶µç›– sing-box é…ç½®ã€Tunnel å·¥ä½œåŸç†ä¸å¸¸è§æ•…éšœæ’æŸ¥æ¸…å•ã€‚">
    <meta name="generator" content="Hugo 0.111.3">
    
    
    
    
      <meta name="robots" content="noindex, nofollow">
    

    
<link rel="stylesheet" href="/lumi-tech-blog/ananke/css/main.min.css" >



    <script type="module">
  import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
  mermaid.initialize({ startOnLoad: true });
  
  
  document.addEventListener('DOMContentLoaded', () => {
    const codeBlocks = document.querySelectorAll('pre > code.language-mermaid');
    codeBlocks.forEach((block) => {
      const pre = block.parentElement;
      const content = block.textContent;
      const div = document.createElement('div');
      div.className = 'mermaid';
      div.textContent = content;
      pre.replaceWith(div);
    });
    mermaid.run();
  });
</script>

    
    
      

    

    
    
    <meta property="og:title" content="ä¿å§†çº§ VLESS &#43; Reality &amp; CDN åŠ é€Ÿå…¨æŒ‡å—" />
<meta property="og:description" content="ä¿å§†çº§ VLESS&#43;Reality æ•™ç¨‹ï¼šå•æœåŠ¡å™¨éƒ¨ç½²ç›´è¿ä¸ CDN å¤‡ç”¨çº¿è·¯ï¼Œæ¶µç›– sing-box é…ç½®ã€Tunnel å·¥ä½œåŸç†ä¸å¸¸è§æ•…éšœæ’æŸ¥æ¸…å•ã€‚" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://Lumicreator.github.io/lumi-tech-blog/posts/vpn-tutorial/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-05-01T00:00:00+00:00" />
<meta property="article:modified_time" content="2024-05-01T00:00:00+00:00" />
<meta itemprop="name" content="ä¿å§†çº§ VLESS &#43; Reality &amp; CDN åŠ é€Ÿå…¨æŒ‡å—">
<meta itemprop="description" content="ä¿å§†çº§ VLESS&#43;Reality æ•™ç¨‹ï¼šå•æœåŠ¡å™¨éƒ¨ç½²ç›´è¿ä¸ CDN å¤‡ç”¨çº¿è·¯ï¼Œæ¶µç›– sing-box é…ç½®ã€Tunnel å·¥ä½œåŸç†ä¸å¸¸è§æ•…éšœæ’æŸ¥æ¸…å•ã€‚"><meta itemprop="datePublished" content="2024-05-01T00:00:00+00:00" />
<meta itemprop="dateModified" content="2024-05-01T00:00:00+00:00" />
<meta itemprop="wordCount" content="501">
<meta itemprop="keywords" content="Reality,VLESS,CDN,Cloudflare,sing-box,X-UI," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="ä¿å§†çº§ VLESS &#43; Reality &amp; CDN åŠ é€Ÿå…¨æŒ‡å—"/>
<meta name="twitter:description" content="ä¿å§†çº§ VLESS&#43;Reality æ•™ç¨‹ï¼šå•æœåŠ¡å™¨éƒ¨ç½²ç›´è¿ä¸ CDN å¤‡ç”¨çº¿è·¯ï¼Œæ¶µç›– sing-box é…ç½®ã€Tunnel å·¥ä½œåŸç†ä¸å¸¸è§æ•…éšœæ’æŸ¥æ¸…å•ã€‚"/>

	<style>
   
  .prose table, .nested-copy-line-height table {
    border-collapse: collapse;
    width: 100%;
    margin-bottom: 2rem;
    border: 1px solid #444;
    background-color: #1a1a1a;
    color: #eee;
  }
  .prose th, .prose td, .nested-copy-line-height th, .nested-copy-line-height td {
    padding: 12px 15px;
    text-align: left;
    border: 1px solid #444;
  }
  .prose th, .nested-copy-line-height th {
    background-color: #333;
    font-weight: bold;
    color: #fff;
    text-transform: uppercase;
    font-size: 0.85rem;
    letter-spacing: 0.05em;
  }
  .prose tr:nth-child(even), .nested-copy-line-height tr:nth-child(even) {
    background-color: #222;
  }
  .prose tr:hover, .nested-copy-line-height tr:hover {
    background-color: #2a2a2a;
  }
   
  .prose td code, .nested-copy-line-height td code {
    background-color: #333;
    padding: 2px 4px;
    border-radius: 4px;
    color: #ffb86c;
  }
</style>

  </head>

  <body class="ma0 avenir bg-near-white DEV">

    
   
  

  <header>
    <div class="bg-near-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="/lumi-tech-blog/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        Lumi&#39;s Tech Blog
      
    </a>
    <div class="flex-l items-center">
      

      
      
<div class="ananke-socials">
  
</div>

    </div>
  </div>
</nav>

    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw8 center ph3">
    <header class="mt4 w-100">
      <aside class="instapaper_ignoref b helvetica tracked">
          
        POSTS
      </aside>
      










  <div id="sharing" class="mt3 ananke-socials">
    
  </div>


      <h1 class="f1 athelas mt3 mb1">ä¿å§†çº§ VLESS &#43; Reality &amp; CDN åŠ é€Ÿå…¨æŒ‡å—</h1>
      
      <p class="tracked">
        By <strong>Lumi</strong>
      </p>
      
      
      
      <time class="f6 mv4 dib tracked" datetime="2024-05-01T00:00:00Z">May 1, 2024</time>
      

      
      
    </header>
    <div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><blockquote>
<p>è¿™æ˜¯ä¸€ä»½ä»é›¶åˆ°ä¸Šçº¿çš„ä¸“ä¸šæ•™ç¨‹ï¼Œæ¶µç›– <strong>VLESS + Reality ç›´è¿</strong> ä¸ <strong>VMess+WS+TLS ç» CDN</strong> çš„åŒçº¿è·¯æ–¹æ¡ˆï¼Œé™„å¸¦å·¥ä½œåŸç†ã€æ’é”™ä¸æ€§èƒ½ä¼˜åŒ–å»ºè®®ã€‚é€‚åˆå…·å¤‡åŸºç¡€ Linux ç»éªŒçš„è¯»è€…ã€‚</p>
</blockquote>
<h2 id="ç›®å½•">ç›®å½•</h2>
<ol>
<li>ä¸ºä»€ä¹ˆè¦åŒçº¿è·¯ï¼ˆReality ç›´è¿ + CDN å¤‡ç”¨ï¼‰</li>
<li>å‰ç½®æ¡ä»¶ä¸è§„åˆ’</li>
<li>æœåŠ¡ç«¯éƒ¨ç½²æ­¥éª¤</li>
<li>å®¢æˆ·ç«¯é…ç½®ç¤ºä¾‹</li>
<li>å¦‚ä½•ç†è§£ Cloudflare Tunnel çš„å·¥ä½œæ–¹å¼</li>
<li>å¸¸è§ 502 / è¶…æ—¶é”™è¯¯æ’æŸ¥</li>
<li>ä½å»¶è¿Ÿä¼˜åŒ–æŒ‡å—</li>
<li>å®‰å…¨ä¸è¿ç»´æ¸…å•</li>
</ol>
<hr>
<h2 id="1-ä¸ºä»€ä¹ˆè¦åŒçº¿è·¯">1. ä¸ºä»€ä¹ˆè¦åŒçº¿è·¯ï¼Ÿ</h2>
<ul>
<li><strong>æŠ—å°é”ä¸ç¨³å®šæ€§</strong>ï¼šReality ç›´è¿ä¸ä¾èµ–åŸŸåæˆ– CDNï¼ŒæŠ—å¹²æ‰°å¼ºï¼›CDN çº¿è·¯å¯åœ¨åŸŸåé­é‡å¹²æ‰°æ—¶å¿«é€Ÿåˆ‡æ¢ã€‚</li>
<li><strong>é€Ÿåº¦ä¸ä½“éªŒ</strong>ï¼šç›´è¿å»¶è¿Ÿä½ã€æ¡æ‰‹çŸ­ï¼›è·¨å¢ƒé“¾è·¯æ‹¥å¡æˆ–æ™šé«˜å³°æ—¶ï¼Œå¯ç”¨ CDN çº¿è·¯å€ŸåŠ©è¾¹ç¼˜èŠ‚ç‚¹ç»•è·¯æé€Ÿã€‚</li>
<li><strong>çµæ´»æ‰©å±•</strong>ï¼šä¸¤æ¡çº¿è·¯å¹¶è¡Œï¼Œå®¢æˆ·ç«¯å¯æŒ‰å»¶è¿Ÿ/å¥åº·åº¦è‡ªåŠ¨åˆ‡æ¢ï¼Œä¹Ÿå¯æ‰‹åŠ¨ä¸€é”®åˆ‡æ¢ã€‚</li>
</ul>
<h2 id="2-å‰ç½®æ¡ä»¶ä¸è§„åˆ’">2. å‰ç½®æ¡ä»¶ä¸è§„åˆ’</h2>
<ul>
<li><strong>æœåŠ¡å™¨</strong>ï¼šå¢ƒå¤– VPSï¼ˆDebian 11+/Ubuntu 22.04ï¼Œ1C1G+ï¼Œroot æƒé™ï¼‰ã€‚</li>
<li><strong>åŸŸå</strong>ï¼šç”¨äº CDN æ–¹æ¡ˆï¼›Reality ç›´è¿å¯ä¸ä¾èµ–åŸŸåã€‚</li>
<li><strong>åŸºç¡€èƒ½åŠ›</strong>ï¼šSSHã€ç¼–è¾‘é…ç½®ã€æŸ¥çœ‹æ—¥å¿—ã€‚</li>
<li><strong>ç«¯å£è§„åˆ’</strong>ï¼šå»ºè®® Reality ç”¨ 443/8443 æˆ–é«˜ä½éšæœºç«¯å£ï¼›WS ç«¯å£ 443/8443ï¼Œä¸é˜²ç«å¢™æ”¾è¡Œä¸€è‡´ã€‚</li>
</ul>
<h2 id="3-æœåŠ¡ç«¯éƒ¨ç½²">3. æœåŠ¡ç«¯éƒ¨ç½²</h2>
<h3 id="31-å¼€å¯-bbræ¨è">3.1 å¼€å¯ BBRï¼ˆæ¨èï¼‰</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>uname -r
</span></span><span style="display:flex;"><span>cat <span style="color:#e6db74">&lt;&lt;&#39;EOF&#39; | sudo tee /etc/sysctl.d/99-bbr.conf
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">net.core.default_qdisc=fq
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">net.ipv4.tcp_congestion_control=bbr
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">EOF</span>
</span></span><span style="display:flex;"><span>sudo sysctl --system
</span></span><span style="display:flex;"><span>sysctl net.ipv4.tcp_congestion_control net.core.default_qdisc
</span></span></code></pre></div><p>è¾“å‡ºå« <code>bbr</code> å’Œ <code>fq</code> å³ç”Ÿæ•ˆã€‚</p>
<h3 id="32-å®‰è£…-sing-boxreality-ç›´è¿">3.2 å®‰è£… sing-boxï¼ˆReality ç›´è¿ï¼‰</h3>
<p><strong>æ–¹æ¡ˆ Aï¼šä¸€é”®è„šæœ¬ï¼ˆå¿«é€Ÿä¸Šæ‰‹ï¼‰</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>bash &lt;<span style="color:#f92672">(</span>curl -fsSL https://raw.githubusercontent.com/ok233wz/reality-ezpz/main/install.sh<span style="color:#f92672">)</span>
</span></span></code></pre></div><p>å®‰è£…åè®°å½•ï¼š<code>uuid</code>ã€ç«¯å£ã€<code>serverName</code>ã€<code>short_id</code>ã€Public/Private Keyã€‚</p>
<p><strong>æ–¹æ¡ˆ Bï¼šå®˜æ–¹è„šæœ¬ï¼ˆä¾¿äºè‡ªå®šä¹‰ï¼‰</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo bash -c <span style="color:#e6db74">&#39;wget -O- https://sing-box.app/install.sh | bash&#39;</span>
</span></span></code></pre></div><p>å…³é”®å­—æ®µï¼ˆ<code>/etc/sing-box/config.json</code>ï¼‰ï¼š</p>
<ul>
<li><code>type: vless</code>ï¼Œ<code>flow: xtls-rprx-vision</code></li>
<li><code>reality</code>: <code>private_key</code>/<code>public_key</code>ã€<code>server_name</code>(SNI)ã€<code>short_id</code></li>
<li><code>dest/server_name</code> é€‰çƒ­é—¨ HTTPS ç«™ç‚¹ï¼Œä¾‹å¦‚ <code>www.microsoft.com:443</code></li>
</ul>
<p><strong>Reality å…¥ç«™ç¤ºä¾‹</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;inbounds&#34;</span>: [
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;type&#34;</span>: <span style="color:#e6db74">&#34;vless&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;listen&#34;</span>: <span style="color:#e6db74">&#34;0.0.0.0&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;listen_port&#34;</span>: <span style="color:#ae81ff">443</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;users&#34;</span>: [{<span style="color:#f92672">&#34;uuid&#34;</span>: <span style="color:#e6db74">&#34;&lt;uuid&gt;&#34;</span>, <span style="color:#f92672">&#34;flow&#34;</span>: <span style="color:#e6db74">&#34;xtls-rprx-vision&#34;</span>}],
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;tls&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;enabled&#34;</span>: <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;reality&#34;</span>: {
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&#34;dest&#34;</span>: <span style="color:#e6db74">&#34;www.microsoft.com:443&#34;</span>,
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&#34;server_name&#34;</span>: <span style="color:#e6db74">&#34;www.microsoft.com&#34;</span>,
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&#34;private_key&#34;</span>: <span style="color:#e6db74">&#34;&lt;private-key&gt;&#34;</span>,
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&#34;short_id&#34;</span>: <span style="color:#e6db74">&#34;a1b2c3d4&#34;</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  ]
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="33-å®‰è£…-x-uivmesswstlsç»-cdn">3.3 å®‰è£… X-UIï¼ˆVMess+WS+TLSï¼Œç» CDNï¼‰</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl -fsSL https://get.docker.com | sh
</span></span><span style="display:flex;"><span>sudo systemctl enable --now docker
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>mkdir -p /opt/x-ui <span style="color:#f92672">&amp;&amp;</span> cd /opt/x-ui
</span></span><span style="display:flex;"><span>cat &gt; docker-compose.yml <span style="color:#e6db74">&lt;&lt;&#39;EOF&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">version: &#39;3&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">services:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  xui:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    image: enwaiax/x-ui:latest
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    container_name: x-ui
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    restart: unless-stopped
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    network_mode: host
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    volumes:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">      - ./db/:/etc/x-ui/
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">      - ./cert/:/root/cert/
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    environment:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">      - XRAY_VMESS_AEAD_FORCED=true
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">EOF</span>
</span></span><span style="display:flex;"><span>sudo docker compose up -d
</span></span></code></pre></div><p>ç™»å½•é¢æ¿ï¼ˆé»˜è®¤ 54321ï¼‰ï¼Œ<strong>ç«‹åˆ»ä¿®æ”¹ç”¨æˆ·å/å¯†ç /ç«¯å£</strong>ã€‚</p>
<p>åœ¨é¢æ¿åˆ›å»º <strong>VMess + WebSocket + TLS</strong>ï¼š</p>
<ul>
<li>ä¼ è¾“ï¼šWSï¼Œè·¯å¾„å¦‚ <code>/ws123</code>ï¼ˆéšæœºï¼‰ã€‚</li>
<li>TLSï¼šå¼€å¯ï¼›è¯ä¹¦è‡ªç­¾æˆ– ACMEã€‚</li>
<li>åŸŸåï¼šè§£æåˆ°æœåŠ¡å™¨ IPï¼ŒCDNï¼ˆå¦‚ Cloudflareï¼‰ä»£ç†éœ€â€œæ©™è‰²äº‘â€å¼€å¯ã€‚</li>
</ul>
<p><strong>å®¢æˆ·ç«¯å¯¼å‡ºæ‘˜è¦</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;add&#34;</span>: <span style="color:#e6db74">&#34;your.domain.com&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;port&#34;</span>: <span style="color:#ae81ff">443</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;id&#34;</span>: <span style="color:#e6db74">&#34;&lt;uuid&gt;&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;net&#34;</span>: <span style="color:#e6db74">&#34;ws&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;path&#34;</span>: <span style="color:#e6db74">&#34;/ws123&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;tls&#34;</span>: <span style="color:#e6db74">&#34;tls&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;host&#34;</span>: <span style="color:#e6db74">&#34;your.domain.com&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="4-å®¢æˆ·ç«¯é…ç½®ç¤ºä¾‹">4. å®¢æˆ·ç«¯é…ç½®ç¤ºä¾‹</h2>
<h3 id="clash--clash-meta">Clash / Clash Meta</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">proxies</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#e6db74">&#34;Reality-Direct&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">type</span>: <span style="color:#ae81ff">vless</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">server</span>: <span style="color:#ae81ff">your.server.ip</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">port</span>: <span style="color:#ae81ff">443</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">uuid</span>: <span style="color:#ae81ff">&lt;uuid&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">tls</span>: <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">flow</span>: <span style="color:#ae81ff">xtls-rprx-vision</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">servername</span>: <span style="color:#ae81ff">www.microsoft.com</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">reality-opts</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">public-key</span>: <span style="color:#ae81ff">&lt;public-key&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">short-id</span>: <span style="color:#ae81ff">a1b2c3d4</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">udp</span>: <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#e6db74">&#34;CDN-VMess-WS&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">type</span>: <span style="color:#ae81ff">vmess</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">server</span>: <span style="color:#ae81ff">your.domain.com</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">port</span>: <span style="color:#ae81ff">443</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">uuid</span>: <span style="color:#ae81ff">&lt;uuid&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">alterId</span>: <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">cipher</span>: <span style="color:#ae81ff">auto</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">tls</span>: <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">network</span>: <span style="color:#ae81ff">ws</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">ws-opts</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/ws123</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">headers</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">Host</span>: <span style="color:#ae81ff">your.domain.com</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">udp</span>: <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">proxy-groups</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#e6db74">&#34;ğŸš€ Proxy&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">type</span>: <span style="color:#ae81ff">select</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">proxies</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">Reality-Direct</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">CDN-VMess-WS</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">DIRECT</span>
</span></span></code></pre></div><h3 id="shadowrocketios">Shadowrocketï¼ˆiOSï¼‰</h3>
<ul>
<li>Realityï¼šå¡«æœåŠ¡å™¨ IPã€ç«¯å£ã€UUIDã€Public Keyã€Short IDã€SNIï¼›ä¼ è¾“é€‰ Vision/Realityã€‚</li>
<li>VMess+WSï¼šæœåŠ¡å™¨åŸŸåï¼Œç«¯å£ 443ï¼ŒUUIDï¼ŒTLS å¼€å¯ï¼ŒWS è·¯å¾„ <code>/ws123</code>ï¼ŒHost å¡«åŸŸåã€‚</li>
<li>å»ºè®®åœ¨å®¢æˆ·ç«¯åˆ›å»ºã€ŒæŒ‰å»¶è¿Ÿæ’åºã€æˆ–ã€Œè‡ªåŠ¨åˆ‡æ¢ã€åˆ—è¡¨ã€‚</li>
</ul>
<hr>
<h2 id="5-how-cloudflare-tunnel-works">5. How Cloudflare Tunnel Works</h2>
<ul>
<li><strong>å®šä½</strong>ï¼šCloudflare Tunnelï¼ˆcloudflaredï¼‰åœ¨æœåŠ¡å™¨ç«¯åˆ›å»ºä¸€æ¡åˆ° Cloudflare è¾¹ç¼˜çš„æŒä¹…å‡ºç«™éš§é“ï¼Œæ— éœ€æš´éœ²å…¥ç«™ç«¯å£ã€‚</li>
<li><strong>æµç¨‹</strong>ï¼š
<ol>
<li>æœåŠ¡å™¨ä¸Šçš„ <code>cloudflared</code> ä¸»åŠ¨è¿æ¥æœ€è¿‘çš„ Cloudflare è¾¹ç¼˜èŠ‚ç‚¹ã€‚</li>
<li>ç”¨æˆ·è®¿é—®åŸŸå â†’ DNS è§£æåˆ° Cloudflare â†’ æµé‡ç»å·²å»ºç«‹çš„éš§é“å›æºåˆ°æœ¬æœºæœåŠ¡ã€‚</li>
<li>æ”¯æŒ <code>--url http://localhost:PORT</code> æ–¹å¼å°†æœ¬åœ°æœåŠ¡æ˜ å°„åˆ°å…¬ç½‘åŸŸåï¼Œä¹Ÿå¯é…åˆ <code>--protocol h2mux/quic</code> æé«˜æ¡æ‰‹ä¸ç©¿é€æ•ˆç‡ã€‚</li>
</ol>
</li>
<li><strong>å¯¹æ¯”</strong>ï¼š
<ul>
<li>ä¼ ç»Ÿåä»£ï¼šéœ€åœ¨æœåŠ¡å™¨å¼€æ”¾ 80/443ï¼Œå—é˜²ç«å¢™/è¿è¥å•†é™åˆ¶ã€‚</li>
<li>Tunnelï¼šæ— å…¥ç«™æš´éœ²ï¼Œç©¿é€é˜»æ–­èƒ½åŠ›æ›´å¥½ï¼Œè¯ä¹¦ä¸ WAF ç”± Cloudflare å¤„ç†ã€‚</li>
</ul>
</li>
<li><strong>æœ€ä½³å®è·µ</strong>ï¼š
<ul>
<li>ä¸º Tunnel ä¸“ç”¨å­åŸŸï¼ˆå¦‚ <code>edge.example.com</code>ï¼‰å•ç‹¬åˆ›å»ºï¼›</li>
<li>è¿è¡Œå¤šæ¡éš§é“åšé«˜å¯ç”¨ï¼›</li>
<li>é€‰æ‹© <code>--protocol quic</code> è·å–æ›´ä½æ—¶å»¶ä¸æŠ–åŠ¨ã€‚</li>
</ul>
</li>
</ul>
<h2 id="6-troubleshooting-common-502--timeout-errors">6. Troubleshooting Common 502 / Timeout Errors</h2>
<ul>
<li><strong>TLS/è¯ä¹¦é—®é¢˜</strong>ï¼š
<ul>
<li>502 å¤šè§äºè¯ä¹¦ä¸åŒ¹é…æˆ–è¿‡æœŸï¼›æ£€æŸ¥æ—¶é—´åŒæ­¥ï¼ˆ<code>timedatectl</code>ï¼‰ã€‚</li>
<li>åœ¨ Cloudflare é¢æ¿é€‰æ‹©ã€Œå®Œå…¨ï¼ˆä¸¥æ ¼ï¼‰ã€æ¨¡å¼å¹¶ç¡®ä¿è¯ä¹¦åˆæ³•ã€‚</li>
</ul>
</li>
<li><strong>WS è·¯å¾„/ç«¯å£ä¸ä¸€è‡´</strong>ï¼šå®¢æˆ·ç«¯ <code>path</code> å¿…é¡»ä¸æœåŠ¡ç«¯ä¸€è‡´ï¼›ç«¯å£ã€é˜²ç«å¢™éœ€æ”¾è¡Œã€‚</li>
<li><strong>CDN ä»£ç†æœªå¼€å¯æˆ–ç¼“å­˜å¹²æ‰°</strong>ï¼šç¡®ä¿æ©™è‰²äº‘å¼€å¯ï¼›å¿…è¦æ—¶åœ¨ Cloudflare è§„åˆ™ä¸­ä¸º WS è·¯å¾„ç¦ç”¨ç¼“å­˜ã€‚</li>
<li><strong>å›æºè¶…æ—¶</strong>ï¼š
<ul>
<li>æœåŠ¡å™¨å‹åŠ›è¿‡é«˜æˆ–è¿›ç¨‹å´©æºƒ â†’ <code>docker logs -f x-ui</code> / <code>journalctl -u sing-box -e</code>ã€‚</li>
<li>è¾¹ç¼˜åˆ°æºç«™é“¾è·¯å·® â†’ åˆ‡æ¢æ•°æ®ä¸­å¿ƒï¼ˆæ›´æ¢åŸŸåè§£æåˆ°å…¶ä»– PoPï¼‰æˆ–ä¸´æ—¶æ”¹ç›´è¿ã€‚</li>
</ul>
</li>
<li><strong>SNI / Host ä¸åŒ¹é…</strong>ï¼šReality çš„ <code>server_name</code> ä¸å®¢æˆ·ç«¯ä¸€è‡´ï¼›WS çš„ <code>Host</code> å¤´ä¸è¯ä¹¦åŸŸåä¸€è‡´ã€‚</li>
<li><strong>ç«¯å£è¢«å ç”¨</strong>ï¼š443/8443 è¢«å…¶ä»–æœåŠ¡å ç”¨ä¼šå¯¼è‡´æ¡æ‰‹å¤±è´¥ï¼›ç”¨ <code>ss -tlnp</code> æ’æŸ¥å¹¶è°ƒæ•´ã€‚</li>
</ul>
<h2 id="7-optimizing-for-low-latency">7. Optimizing for Low Latency</h2>
<ul>
<li><strong>ä¼˜å…ˆ Reality ç›´è¿</strong>ï¼šå‡å°‘ä¸­è½¬ç¯èŠ‚ï¼›é€‰ç¨³å®šçš„çƒ­é—¨ SNI ä»¥è·å¾—æ›´ä½³è·¯ç”±ã€‚</li>
<li><strong>BBR ä¸å†…æ ¸å‚æ•°</strong>ï¼šå·²å¯ç”¨ BBRï¼›å¦‚éœ€è¿›ä¸€æ­¥è°ƒæ•´å¯è®¾ç½® <code>net.ipv4.tcp_fastopen = 3</code>ï¼ˆå®¢æˆ·ç«¯äº¦éœ€æ”¯æŒï¼‰ã€‚</li>
<li><strong>Cloudflare PoP é€‰æ‹©</strong>ï¼šä¸åŒåŸŸåã€å‰ç¼€æˆ–è´Ÿè½½å‡è¡¡ç­–ç•¥å¯å‘½ä¸­æ›´è¿‘çš„è¾¹ç¼˜èŠ‚ç‚¹ï¼›å°è¯•å¤šåŸŸåæµ‹è¯• RTTã€‚</li>
<li><strong>åè®®ä¸æ¡æ‰‹</strong>ï¼š
<ul>
<li>Realityï¼šæ¡æ‰‹çŸ­ã€åŠ å¯†å¼€é”€ä½ï¼Œé€‚åˆå®æ—¶åº”ç”¨ã€‚</li>
<li>Tunnelï¼š<code>--protocol quic</code> å¾€å¾€ä¼˜äº h2muxï¼Œå°¤å…¶åœ¨é«˜ä¸¢åŒ…ç¯å¢ƒã€‚</li>
</ul>
</li>
<li><strong>å®¢æˆ·ç«¯ç­–ç•¥</strong>ï¼šä½¿ç”¨ã€ŒæŒ‰å»¶è¿Ÿ/å¥åº·åº¦è‡ªåŠ¨åˆ‡æ¢ã€ï¼›å®šæœŸæµ‹é€Ÿï¼Œç§»é™¤é«˜æŠ–åŠ¨èŠ‚ç‚¹ã€‚</li>
<li><strong>UDP æ”¯æŒ</strong>ï¼šå¼€å¯ <code>udp: true</code> ä»¥ä¼˜åŒ–æ¸¸æˆ/å®æ—¶è¯­éŸ³ä½“éªŒã€‚</li>
</ul>
<h2 id="8-å®‰å…¨ä¸è¿ç»´æ¸…å•">8. å®‰å…¨ä¸è¿ç»´æ¸…å•</h2>
<ul>
<li>æ›´æ”¹ X-UI é»˜è®¤ç™»å½•ç«¯å£/å¯†ç ï¼Œé™åˆ¶é¢æ¿æš´éœ²ï¼ˆå¯ä»…å…è®¸æœ¬åœ°æˆ–å®‰å…¨ç½‘æ®µè®¿é—®ï¼‰ã€‚</li>
<li>å®šæœŸæ›´æ–°ï¼š<code>sudo apt update &amp;&amp; apt upgrade</code>ï¼Œ<code>docker pull enwaiax/x-ui &amp;&amp; docker compose up -d</code>ï¼Œ<code>systemctl restart sing-box</code>ã€‚</li>
<li>é˜²ç«å¢™ï¼šåªæ”¾è¡Œå®é™…ä½¿ç”¨ç«¯å£ï¼ˆå¦‚ 443/8443/54321ï¼‰ï¼Œå…¶ä½™å…³é—­ï¼›å¯ç”¨ <code>ufw</code>/<code>firewalld</code>ã€‚</li>
<li>æ—¥å¿—å·¡æ£€ï¼š
<ul>
<li>sing-boxï¼š<code>journalctl -u sing-box -e</code></li>
<li>x-ui å®¹å™¨ï¼š<code>docker logs -f x-ui</code></li>
</ul>
</li>
<li>å¤‡ä»½ï¼šå®šæœŸå¤‡ä»½ sing-box é…ç½®ã€X-UI æ•°æ®åº“ï¼ˆ<code>/opt/x-ui/db/</code>ï¼‰ã€‚</li>
</ul>
<hr>
<p><strong>å®Œæˆï¼</strong> ç°åœ¨ä½ æ‹¥æœ‰å…·å¤‡æŠ—å°é”èƒ½åŠ›çš„ Reality ç›´è¿ä¸»çº¿è·¯ä¸ Cloudflare CDN å¤‡ç”¨çº¿è·¯ï¼Œå¹¶æŒæ¡æ’é”™ä¸ä¼˜åŒ–è¦ç‚¹ã€‚ç¥ä½¿ç”¨é¡ºç•… ğŸš€</p>
<ul class="pa0">
  
   <li class="list di">
     <a href="/tags/reality" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">Reality</a>
   </li>
  
   <li class="list di">
     <a href="/tags/vless" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">VLESS</a>
   </li>
  
   <li class="list di">
     <a href="/tags/cdn" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">CDN</a>
   </li>
  
   <li class="list di">
     <a href="/tags/cloudflare" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">Cloudflare</a>
   </li>
  
   <li class="list di">
     <a href="/tags/sing-box" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">sing-box</a>
   </li>
  
   <li class="list di">
     <a href="/tags/x-ui" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">X-UI</a>
   </li>
  
</ul>
<div class="mt6 instapaper_ignoref">
      
      
      </div>
    </div>

    <aside class="w-30-l mt6-l">




</aside>

  </article>

    </main>
    <footer class="bg-near-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="https://Lumicreator.github.io/lumi-tech-blog/" >
    &copy;  Lumi's Tech Blog 2026 
  </a>
    <div>
<div class="ananke-socials">
  
</div>
</div>
  </div>
</footer>

  </body>
</html>
